<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlusÂ®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>MineSweeper</title>
 </head>
 <body onload=startGame()>
 <!--
	The below set of code is for future enhancement.
	The player can select the number of candies and level of difficulty
 <div>
	<input placeholder="Number of candies">
	</input>
	<select>
		<option value="1">Easy</option>
		<option value="2">Medium</option>
		<option value="3">Tough</option>
	</select>
	<button onClick="startGame()">Start Game
	</button>
 </div>
 -->
 <br>
	<div><!-- Table to hold the buttons in a table format
			Each button to have its own ID -->
		<table border=2 id="MasterTable">
			<tr>
				<td>
					<button id=1 onclick="clickButton(id)">1</button>
				</td>
				<td>
					<button id=2 onclick="clickButton(id)">2</button>
				</td>
				<td>
					<button id=3 onclick="clickButton(id)">3</button>
				</td>
			</tr>
			<tr>
				<td>
					<button id=4 onclick="clickButton(id)">4</button>
				</td>
				<td>
					<button id=5 onclick="clickButton(id)">5</button>
				</td>
				<td>
					<button id=6 onclick="clickButton(id)">6</button>
				</td>
			</tr>
			<tr>
				<td>
					<button id=7 onclick="clickButton(id)">7</button>
				</td>
				<td>
					<button id=8 onclick="clickButton(id)">8</button>
				</td>
				<td>
					<button id=9 onclick="clickButton(id)">9</button>
				</td>
			</tr>
		</table>
	</div>
 </body>
 <script>		
	// This function will start the game by hiding the numbers and then setting the candies in a different buttons.
	function startGame()
	{
		hideNumbers(); //method will hide all the buttons.
		setCandies(); //method will set the candies in different buttons
	}

	//As of now the number of buttons is preset to 9 and will be modifier later
	function setCandies()
	{
		for(var i=1;i<=9;i++)
		{
			document.getElementById(i).innerText="0"; //Update the text of button with "0". This will not visible untill button is clicked.
			document.getElementById(i).value=0; //Update the value inside the button to 0 before the start of the game.
		}
		addCandies(); //method will add 3 candies in random buttons

	}

	function hideNumbers()
	{
		for(var i=1;i<=9;i++)
		{
			document.getElementById(i).style.color="white"; //hiding the text on the button

		}
	}

	function addCandies()
	{
		var candiesArray=[]; //candiesArray variable will store the location of the candies. It will have "" as the first element for now.
		//candiesArray.shift();
		for(var i=0,j=1;candiesArray.length<=3;i++)
		{
			var m=(Math.floor(Math.random() *9))+1; //Generate a random number ranging from 1 to 9
			//console.log("i= "+i+" m= "+m+ " type: "+ typeof(m)); //This will be printed in console screen
			if(!candiesArray.includes(m)) //add candy to candiesArray if and only if the number is not existing in the candiesArray
			{	
				candiesArray[j++]=m; //Add the candies at the given position and increment j
				document.getElementById(m).innerText="X"; //update innerText of the button to "X"
				document.getElementById(m).value="X"; //update the value of the button to "X"
				document.getElementById(m).style.color="white"; //update the color of the text to white
				updateNumbers(m); //This will check the neighbor buttons and update the value of that button if it doesn't contain candy
			}
		}
		//alert(candiesArray);
		candiesArray.shift(); //Remove the first element("") of the candiesArray which gets added to it upon creation.
	}

	function updateNumbers(m)
	{
		var num=document.getElementById(m).id; //Get the ID of the clicked button
		//The below variables are used to identify the neighboring buttons of the clicked button
		candyBox1=Number(num)-4;
		candyBox2=Number(num)-3;
		candyBox3=Number(num)-2;
		candyBox4=Number(num)-1;
		candyBox5=Number(num)-0;
		candyBox6=Number(num)+1;
		candyBox7=Number(num)+2;
		candyBox8=Number(num)+3;
		candyBox9=Number(num)+4;

		switch(num) //based on the clicked button, check and update the neighbor buttons
		{
			case '1':
				checkCandies(candyBox6,candyBox8,candyBox9);
				break;
			case '3':
				checkCandies(candyBox4,candyBox7,candyBox8);
				break;
			case '7':
				checkCandies(candyBox2,candyBox3,candyBox6);
				break;
			case '9':
				checkCandies(candyBox1,candyBox2,candyBox4);
				break;
			case '2':
				checkCandies(candyBox4,candyBox6,candyBox7,candyBox8,candyBox9);
				break;
			case '4':
				checkCandies(candyBox2,candyBox3,candyBox6,candyBox8,candyBox9);
				break;
			case '6':
				checkCandies(candyBox1,candyBox2,candyBox4,candyBox7,candyBox8);
				break;
			case '8':
				checkCandies(candyBox1,candyBox2,candyBox3,candyBox4,candyBox6);
				break;
			default:
				checkCandies(candyBox1,candyBox2,candyBox3,candyBox4,candyBox6,candyBox7,candyBox8,candyBox9);
				break;
		}
	}

	//Method checks the neighbor buttons and updates the number of candies if not present.
	function checkCandies()
	{
		for(var i=0;i<arguments.length;i++)
			{
					cell=Number(document.getElementById(arguments[i]).value); //get the value of the cell/button
					if(document.getElementById(arguments[i]).innerText!="X") //compare if the text on it is not "X"
					{
						document.getElementById(arguments[i]).style.color="white"; // display the text 
						document.getElementById(arguments[i]).value=cell+1; //increment the value of the button
						document.getElementById(arguments[i]).innerText=cell+1; //update the same on the text
						document.getElementById(arguments[i]).style.textAlign="center"; //Align it to the center
					}
		
			}

	}

	function clickButton(n)
	{
		if(document.getElementById(n).disabled==false)
		{
			document.getElementById(n).style.color="black";
			document.getElementById(n).disabled=true;
			if(document.getElementById(n).innerText!="X")
			{
				revealNeighbourNumbers(n);
			}
			else
			{
				revealAllNumbers();
				alert("gameover");
				
			}
		}
		else
		{
		}
	}

	function revealNeighbourNumbers(n)
	{
		var num=document.getElementById(n).id;
		num1=Number(num)-4;
		num2=Number(num)-3;
		num3=Number(num)-2;
		num4=Number(num)-1;
		num5=Number(num)-0;
		num6=Number(num)+1;
		num7=Number(num)+2;
		num8=Number(num)+3;
		num9=Number(num)+4;
		

		if((Number(document.getElementById(n).value))==0)
		{
			//alert("0");
			switch(num)
			{
				case '1':
					displayNumber(num6,num8,num9);
					break;
				case '3':
					displayNumber(num4,num7,num8);
					break;
				case '7':
					displayNumber(num2,num3,num6);
					break;
				case '9':
					displayNumber(num1,num2,num4);
					break;
				case '2':
					displayNumber(num4,num6,num7,num8,num9);
					break;
				case '4':
					displayNumber(num2,num3,num6,num8,num9);
					break;
				case '6':
					displayNumber(num1,num2,num4,num7,num8);
					break;
				case '8':
					displayNumber(num1,num2,num3,num4,num6);
					break;
				default:
					displayNumber(num1,num2,num3,num4,num6,num7,num8,num9);
					break;
			}

		}
		
		
	}

		function revealAllNumbers()
		{
			for(var i=1;i<=9;i++)
			{
				document.getElementById(i).style.color="black";
			}
		}

		function displayNumber()
		{
			for(var i=0;i<arguments.length;i++)
			{
				if(document.getElementById(arguments[i]).disabled==false)
				{
					if(document.getElementById(arguments[i]).innerText!="X")
					{
						if(document.getElementById(arguments[i]).value==0)
						{
							revealNeighbourNumbers(arguments[i]);
						}
						else
						{
							document.getElementById(arguments[i]).style.color="black";
							document.getElementById(arguments[i]).disabled=true;

						}
						
					}
						
				}
		
			}
			
		}
 </script>
</html>
